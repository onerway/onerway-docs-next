import{bW as e,r as t,I as a,bX as o,bI as r,A as n,bY as l,bZ as i,bp as s,b_ as u,M as c,b$ as d,bU as v,S as f,bg as p,bf as m,D as b,e as I,w as y,g,H as S,b9 as w,E as h,bi as A,o as F,c as T,Y as x}from"./BtL5YkUb.js";function C(o){const r=e({dir:t("ltr")});return a(()=>{var e;return(null==o?void 0:o.value)||(null==(e=r.dir)?void 0:e.value)||"ltr"})}function E(){const e=t(),r=a(()=>{var t,a;return["#text","#comment"].includes(null==(t=e.value)?void 0:t.$el.nodeName)?null==(a=e.value)?void 0:a.$el.nextElementSibling:o(e)});return{primitiveElement:e,currentElement:r}}const M="data-reka-collection-item";function R(e={}){const{key:o="",isProvider:v=!1}=e,f=`${o}CollectionProvider`;let p;if(v){const e=t(new Map),a=t();p={collectionRef:a,itemMap:e},d(f,p)}else p=r(f);const m=n({name:"CollectionSlot",setup(e,{slots:t}){const{primitiveElement:a,currentElement:o}=E();return c(o,()=>{p.collectionRef.value=o.value}),()=>s(u,{ref:a},t)}}),b=n({name:"CollectionItem",inheritAttrs:!1,props:{value:{validator:()=>!0}},setup(e,{slots:t,attrs:a}){const{primitiveElement:o,currentElement:r}=E();return l(t=>{if(r.value){const a=i(r.value);p.itemMap.value.set(a,{ref:r.value,value:e.value}),t(()=>p.itemMap.value.delete(a))}}),()=>s(u,{...a,[M]:"",ref:o},t)}});return{getItems:(e=!1)=>{const t=p.collectionRef.value;if(!t)return[];const a=Array.from(t.querySelectorAll(`[${M}]`)),o=Array.from(p.itemMap.value.values()).sort((e,t)=>a.indexOf(e.ref)-a.indexOf(t.ref));return e?o:o.filter(e=>""!==e.ref.dataset.disabled)},reactiveItems:a(()=>Array.from(p.itemMap.value.values())),itemMapSize:a(()=>p.itemMap.value.size),CollectionSlot:m,CollectionItem:b}}const _={bubbles:!1,cancelable:!0},B={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function K(e,t=!1){const a=v();for(const o of e){if(o===a)return;if(o.focus({preventScroll:t}),v()!==a)return}}const[$,D]=m("RovingFocusGroup"),P=n({__name:"RovingFocusGroup",props:{orientation:{default:void 0},dir:{},loop:{type:Boolean,default:!1},currentTabStopId:{},defaultCurrentTabStopId:{},preventScrollOnEntryFocus:{type:Boolean,default:!1},asChild:{type:Boolean},as:{}},emits:["entryFocus","update:currentTabStopId"],setup(e,{expose:a,emit:o}){const r=e,n=o,{loop:l,orientation:i,dir:s}=f(r),u=C(s),c=p(r,"currentTabStopId",n,{defaultValue:r.defaultCurrentTabStopId,passive:void 0===r.currentTabStopId}),d=t(!1),v=t(!1),m=t(0),{getItems:A,CollectionSlot:F}=R({isProvider:!0});function T(e){const t=!v.value;if(e.currentTarget&&e.target===e.currentTarget&&t&&!d.value){const t=new CustomEvent("rovingFocusGroup.onEntryFocus",_);if(e.currentTarget.dispatchEvent(t),n("entryFocus",t),!t.defaultPrevented){const e=A().map(e=>e.ref).filter(e=>""!==e.dataset.disabled);K([e.find(e=>""===e.getAttribute("data-active")),e.find(e=>e.id===c.value),...e].filter(Boolean),r.preventScrollOnEntryFocus)}}v.value=!1}function x(){setTimeout(()=>{v.value=!1},1)}return a({getItems:A}),D({loop:l,dir:u,orientation:i,currentTabStopId:c,onItemFocus:e=>{c.value=e},onItemShiftTab:()=>{d.value=!0},onFocusableItemAdd:()=>{m.value++},onFocusableItemRemove:()=>{m.value--}}),(e,t)=>(I(),b(S(F),null,{default:y(()=>[g(S(w),{tabindex:d.value||0===m.value?-1:0,"data-orientation":S(i),as:e.as,"as-child":e.asChild,dir:S(u),style:{outline:"none"},onMousedown:t[0]||(t[0]=e=>v.value=!0),onMouseup:x,onFocus:T,onBlur:t[1]||(t[1]=e=>d.value=!1)},{default:y(()=>[h(e.$slots,"default")]),_:3},8,["tabindex","data-orientation","as","as-child","dir"])]),_:3}))}}),O=n({__name:"RovingFocusItem",props:{tabStopId:{},focusable:{type:Boolean,default:!0},active:{type:Boolean},allowShiftKey:{type:Boolean},asChild:{type:Boolean},as:{default:"span"}},setup(e){const t=e,o=$(),r=A(),n=a(()=>t.tabStopId||r),l=a(()=>o.currentTabStopId.value===n.value),{getItems:i,CollectionItem:s}=R();function u(e){if("Tab"===e.key&&e.shiftKey)return void o.onItemShiftTab();if(e.target!==e.currentTarget)return;const a=function(e,t,a){const o=function(e,t){return"rtl"!==t?e:"ArrowLeft"===e?"ArrowRight":"ArrowRight"===e?"ArrowLeft":e}(e.key,a);if(!("vertical"===t&&["ArrowLeft","ArrowRight"].includes(o)||"horizontal"===t&&["ArrowUp","ArrowDown"].includes(o)))return B[o]}(e,o.orientation.value,o.dir.value);if(void 0!==a){if(e.metaKey||e.ctrlKey||e.altKey||!t.allowShiftKey&&e.shiftKey)return;e.preventDefault();let l=[...i().map(e=>e.ref).filter(e=>""!==e.dataset.disabled)];if("last"===a)l.reverse();else if("prev"===a||"next"===a){"prev"===a&&l.reverse();const t=l.indexOf(e.currentTarget);l=o.loop.value?(n=t+1,(r=l).map((e,t)=>r[(n+t)%r.length])):l.slice(t+1)}x(()=>K(l))}var r,n}return F(()=>{t.focusable&&o.onFocusableItemAdd()}),T(()=>{t.focusable&&o.onFocusableItemRemove()}),(e,t)=>(I(),b(S(s),null,{default:y(()=>[g(S(w),{tabindex:l.value?0:-1,"data-orientation":S(o).orientation.value,"data-active":e.active?"":void 0,"data-disabled":e.focusable?void 0:"",as:e.as,"as-child":e.asChild,onMousedown:t[0]||(t[0]=t=>{e.focusable?S(o).onItemFocus(n.value):t.preventDefault()}),onFocus:t[1]||(t[1]=e=>S(o).onItemFocus(n.value)),onKeydown:u},{default:y(()=>[h(e.$slots,"default")]),_:3},8,["tabindex","data-orientation","data-active","data-disabled","as","as-child"])]),_:3}))}});export{B as M,P as _,O as a,R as b,C as u};
