import{r as e,I as t,bV as a,by as o,A as r,bW as n,bX as l,bf as s,bY as i,M as u,bZ as c,bT as d,S as f,bP as v,bN as p,D as m,e as b,w as y,g as I,H as g,b8 as S,E as w,bQ as h,o as A,c as F,Y as T}from"./Dpzt9rve.js";import{u as x}from"./IeN-7bG6.js";function C(){const o=e(),r=t(()=>{var e,t;return["#text","#comment"].includes(null==(e=o.value)?void 0:e.$el.nodeName)?null==(t=o.value)?void 0:t.$el.nextElementSibling:a(o)});return{primitiveElement:o,currentElement:r}}const E="data-reka-collection-item";function M(a={}){const{key:d="",isProvider:f=!1}=a,v=`${d}CollectionProvider`;let p;if(f){const t=e(new Map),a=e();p={collectionRef:a,itemMap:t},c(v,p)}else p=o(v);const m=r({name:"CollectionSlot",setup(e,{slots:t}){const{primitiveElement:a,currentElement:o}=C();return u(o,()=>{p.collectionRef.value=o.value}),()=>s(i,{ref:a},t)}}),b=r({name:"CollectionItem",inheritAttrs:!1,props:{value:{validator:()=>!0}},setup(e,{slots:t,attrs:a}){const{primitiveElement:o,currentElement:r}=C();return n(t=>{if(r.value){const a=l(r.value);p.itemMap.value.set(a,{ref:r.value,value:e.value}),t(()=>p.itemMap.value.delete(a))}}),()=>s(i,{...a,[E]:"",ref:o},t)}});return{getItems:(e=!1)=>{const t=p.collectionRef.value;if(!t)return[];const a=Array.from(t.querySelectorAll(`[${E}]`)),o=Array.from(p.itemMap.value.values()).sort((e,t)=>a.indexOf(e.ref)-a.indexOf(t.ref));return e?o:o.filter(e=>""!==e.ref.dataset.disabled)},reactiveItems:t(()=>Array.from(p.itemMap.value.values())),itemMapSize:t(()=>p.itemMap.value.size),CollectionSlot:m,CollectionItem:b}}const R={bubbles:!1,cancelable:!0},B={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function _(e,t=!1){const a=d();for(const o of e){if(o===a)return;if(o.focus({preventScroll:t}),d()!==a)return}}const[K,P]=p("RovingFocusGroup"),D=r({__name:"RovingFocusGroup",props:{orientation:{default:void 0},dir:{},loop:{type:Boolean,default:!1},currentTabStopId:{},defaultCurrentTabStopId:{},preventScrollOnEntryFocus:{type:Boolean,default:!1},asChild:{type:Boolean},as:{}},emits:["entryFocus","update:currentTabStopId"],setup(t,{expose:a,emit:o}){const r=t,n=o,{loop:l,orientation:s,dir:i}=f(r),u=x(i),c=v(r,"currentTabStopId",n,{defaultValue:r.defaultCurrentTabStopId,passive:void 0===r.currentTabStopId}),d=e(!1),p=e(!1),h=e(0),{getItems:A,CollectionSlot:F}=M({isProvider:!0});function T(e){const t=!p.value;if(e.currentTarget&&e.target===e.currentTarget&&t&&!d.value){const t=new CustomEvent("rovingFocusGroup.onEntryFocus",R);if(e.currentTarget.dispatchEvent(t),n("entryFocus",t),!t.defaultPrevented){const e=A().map(e=>e.ref).filter(e=>""!==e.dataset.disabled);_([e.find(e=>""===e.getAttribute("data-active")),e.find(e=>e.id===c.value),...e].filter(Boolean),r.preventScrollOnEntryFocus)}}p.value=!1}function C(){setTimeout(()=>{p.value=!1},1)}return a({getItems:A}),P({loop:l,dir:u,orientation:s,currentTabStopId:c,onItemFocus:e=>{c.value=e},onItemShiftTab:()=>{d.value=!0},onFocusableItemAdd:()=>{h.value++},onFocusableItemRemove:()=>{h.value--}}),(e,t)=>(b(),m(g(F),null,{default:y(()=>[I(g(S),{tabindex:d.value||0===h.value?-1:0,"data-orientation":g(s),as:e.as,"as-child":e.asChild,dir:g(u),style:{outline:"none"},onMousedown:t[0]||(t[0]=e=>p.value=!0),onMouseup:C,onFocus:T,onBlur:t[1]||(t[1]=e=>d.value=!1)},{default:y(()=>[w(e.$slots,"default")]),_:3},8,["tabindex","data-orientation","as","as-child","dir"])]),_:3}))}}),$=r({__name:"RovingFocusItem",props:{tabStopId:{},focusable:{type:Boolean,default:!0},active:{type:Boolean},allowShiftKey:{type:Boolean},asChild:{type:Boolean},as:{default:"span"}},setup(e){const a=e,o=K(),r=h(),n=t(()=>a.tabStopId||r),l=t(()=>o.currentTabStopId.value===n.value),{getItems:s,CollectionItem:i}=M();function u(e){if("Tab"===e.key&&e.shiftKey)return void o.onItemShiftTab();if(e.target!==e.currentTarget)return;const t=function(e,t,a){const o=function(e,t){return"rtl"!==t?e:"ArrowLeft"===e?"ArrowRight":"ArrowRight"===e?"ArrowLeft":e}(e.key,a);if(!("vertical"===t&&["ArrowLeft","ArrowRight"].includes(o)||"horizontal"===t&&["ArrowUp","ArrowDown"].includes(o)))return B[o]}(e,o.orientation.value,o.dir.value);if(void 0!==t){if(e.metaKey||e.ctrlKey||e.altKey||!a.allowShiftKey&&e.shiftKey)return;e.preventDefault();let l=[...s().map(e=>e.ref).filter(e=>""!==e.dataset.disabled)];if("last"===t)l.reverse();else if("prev"===t||"next"===t){"prev"===t&&l.reverse();const a=l.indexOf(e.currentTarget);l=o.loop.value?(n=a+1,(r=l).map((e,t)=>r[(n+t)%r.length])):l.slice(a+1)}T(()=>_(l))}var r,n}return A(()=>{a.focusable&&o.onFocusableItemAdd()}),F(()=>{a.focusable&&o.onFocusableItemRemove()}),(e,t)=>(b(),m(g(i),null,{default:y(()=>[I(g(S),{tabindex:l.value?0:-1,"data-orientation":g(o).orientation.value,"data-active":e.active?"":void 0,"data-disabled":e.focusable?void 0:"",as:e.as,"as-child":e.asChild,onMousedown:t[0]||(t[0]=t=>{e.focusable?g(o).onItemFocus(n.value):t.preventDefault()}),onFocus:t[1]||(t[1]=e=>g(o).onItemFocus(n.value)),onKeydown:u},{default:y(()=>[w(e.$slots,"default")]),_:3},8,["tabindex","data-orientation","data-active","data-disabled","as","as-child"])]),_:3}))}});export{B as M,D as _,$ as a,M as u};
