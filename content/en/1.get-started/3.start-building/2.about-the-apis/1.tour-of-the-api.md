---
title: Tour of the API
description: See how Onerway API objects fit together and learn best practices for combining them.
draft: true
---

了解 Onerway API 对象如何协同工作，并学习组合它们的最佳实践。

See how Onerway API objects fit together and learn best practices for combining them.

## Onerway API Deep Understanding Guide

如果您知道如何使用 Onerway API，它们将变得强大而灵活。本 API 指南涵盖了帮助您更深入理解 API 的关键信息：

- 我们在各个 API 中使用的核心概念
- 成功支付所经历的路径
- 发挥作用的对象以及如何确定何时需要它们
- 将这些对象结合使用的常见模式和最佳实践

理解这些模式有助于您超越 Onerway 教程中的预写代码。以新颖的方式组合简单模式，并为未来增长做好规划。

The Onerway APIs are powerful and flexible if you know how to use them. This API guide covers key information to help you understand the APIs more deeply:

- The core concepts we use across the APIs
- The path a successful payment takes
- The objects that play a role and how to determine when they're needed
- Common patterns and best practices for using those objects together

Understanding these patterns helps you move beyond the pre-written code in Onerway tutorials. You can combine simple patterns in novel ways and plan for future growth.

## Core Concepts

### Transaction Lifecycle

Onerway 处理交易的流程。

收银台使用交易号来跟踪每个流程。无论正向付款交易，反向退款货争议都会生成一个交易号，您可以通过 [API 查询](https://docs.onerway.com/apis/zh/v0.6/order-query) 每笔交易号的订单状态。

收银台的生命周期是 30 分钟，不可调整。

### Structured Data Transfer

Onerway API 采用结构化数据传输方式，通过标准化的数据对象来处理支付流程。每个 API 请求都遵循明确定义的数据结构，确保支付信息的准确性、完整性和安全性。

在 Onerway API 中，支付请求由多层级的数据对象组成，每个对象负责传递特定类型的信息：

| 数据对象 | 作用 | 说明 |
|----------|------|------|
| **`TxnOrderMsg`** | 交易主体信息 | 包含订单金额、货币、商户信息等核心交易数据 |
| **`Products`** | 商品信息 | 以数组形式组织商品名称、数量、价格等详情 |
| **`Subscription`** | 订阅配置 | 定义订阅周期、频率、试用期等订阅服务参数 |
| **`TransactionAddress`** | 地址信息 | 标准化的账单地址和配送地址结构 |
| **`CardInfo`** | 信用卡信息 | 传递卡号、持卡人姓名、有效期等卡片数据 |
| **`TokenInfo`** | Token 信息 | 用于 Token 化支付的令牌数据 |
| **`LpmsInfo`** | 非卡支付信息 | 配置本地支付方式（如电子钱包、银行转账等） |
| **`mpiInfo`** | 3DS 验证信息 | 传递 3D Secure 验证相关的 MPI 数据 |

无论您是通过直接 API 调用、SDK 集成还是其他方式接入 Onerway，都需要按照这些预定义的数据结构来组织和传输信息。

### Integration Methods

Onerway 提供多种集成方式，以满足不同商户的业务需求。每种方式在用户体验、开发复杂度和品牌呈现上各有特点。

#### 1. Hosted Checkout

**适用场景：** 快速接入，最小化前端开发工作

**集成流程：**

1. 服务端调用 **Checkout API** 创建支付订单
2. 接收响应，当 `status: U` 时表示创建成功，获取 `redirectUrl`
3. 将用户重定向到 `redirectUrl`（Onerway 托管的支付页面）
4. 用户在 Onerway 页面完成支付
5. 支付完成后，用户被重定向回商户的 `returnUrl`

**特点：**

- 完全符合 PCI 合规要求（Onerway 处理所有卡信息）
- 集成最简单，开发周期最短
- 用户需要重定向到 Onerway 托管的支付页面

#### 2. Embedded Checkout (JS SDK)

**适用场景：** 在商户页面内完成支付，保持品牌连贯性

**集成流程：**

1. 服务端调用 API 创建 **Payment Intent**
2. 接收响应，当 `status: U` 时表示创建成功，获取 `redirectUrl` 和 `transactionID`
3. 将 `redirectUrl` 和 `transactionID` 传递给前端
4. 前端加载 Onerway 的 JavaScript SDK
5. 使用 SDK 在页面中渲染内嵌支付表单
6. 用户在商户页面内完成支付，无需跳转

**特点：**

- 支付表单嵌入在商户页面中
- 保持商户网站的视觉风格
- 仍然符合 PCI 合规（卡信息直接传输到 Onerway）
- 用户体验更流畅
- 集成难度中等

#### 3. Direct API

**适用场景：** 完全自定义支付界面和流程

**集成流程：**

1. 商户在前端自行开发支付表单
2. 用户在商户自定义表单中填写支付信息
3. 前端将支付数据提交到商户服务端
4. 服务端调用 Onerway API 发起支付请求
5. 处理响应并向用户展示支付结果

**特点：**

- 完全自定义用户界面
- 用户完全感知不到 Onerway 的存在
- 商户需要具备 PCI DSS 合规资质
- 集成复杂度最高

## Comparison Overview

| 对比项 | 托管收银台 | 内嵌收银台 (JS SDK) | API 直连 |
|--------|-----------|-------------------|----------|
| **集成难度** | ⭐ 简单 | ⭐⭐ 中等 | ⭐⭐⭐ 复杂 |
| **PCI 合规** | Onerway 负责 | Onerway 负责 | 商户自行负责 |
| **界面定制** | 有限 | 中等 | 完全自定义 |
| **品牌呈现** | 显示 Onerway | 最小化 Onerway | 完全隐藏 |
| **用户体验** | 需要跳转 | 页面内完成 | 完全自定义 |
| **开发周期** | 最短 | 适中 | 最长 |

