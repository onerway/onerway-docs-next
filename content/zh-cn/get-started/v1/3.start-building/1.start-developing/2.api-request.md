---
title: 发送你的首个 Onerway API 请求
description: 从创建支付订单开始使用 Onerway API。
order: 1
showToc: true
showNavigation: true
---

每个 Onerway API 调用都必须包含商户认证信息。创建 Onerway 账户后，我们为您生成完整的商户凭证—商户号、秘钥和店铺ID—分别用于沙盒测试和生产环境。**沙盒环境**是隔离的测试环境，让您安全地测试 Onerway 功能而不影响真实交易。**生产环境**用于处理真实的资金流转。

## 开始之前

本指南演示简单的 Onerway API 交互—创建支付订单。深入了解 API 架构和设计原则，请参考 [API 概览](https://docs.onerway.com/apis/zh/v0.6/){badge="API"}。如果您已准备好开始接受真实支付，请查看我们的[支付快速开始](mock/payments/quickstart)。

## 管理你的 API 凭证

默认情况下，每个账户都有完整的 [API 凭证集](development-environment#get-your-api-credentials)，分别用于沙盒环境和生产环境

::warning
如果无法查看您的 API 凭证，请要求您 Onerway 账户的所有者将您添加到其团队中并授予适当权限
::


## 发送你的首个 API 请求

您可以使用 **[Apifox](https://apifox.com/)** 开始探索 Onerway API。Apifox 允许您直接在浏览器中执行 API 请求。由于它在沙盒环境中运行，您无需担心发起任何真实的资金流转。

1. 在 Apifox 平台选择 **[Card Checkout](https://apifox.onerway.com/api-265239300)** 接口
2. 选择 [Card Checkout](https://apifox.onerway.com/api-265239300) 接口，点击接口下方 `Run in
Apifox` 按钮
3. Onerway 已为`Sandbox`环境变量预设默认值
4. 点击 **"Send"** 按钮提交请求

如果一切正常，您将收到以下响应：

::code-collapse

```json {17}
{
    "respCode": "20000",
    "respMsg": "Success",
    "data": {
        "transactionId": "1967964791566110720",
        "merchantTxnId": "268b51e4-cbef-4a39-856b-dcc18f3f6805",
        "merchantNo": "800209",
        "responseTime": "",
        "txnTime": "",
        "orderAmount": "0.50",
        "orderCurrency": "USD",
        "txnAmount": "",
        "txnCurrency": null,
        "txnTimeZone": null,
        "status": "U",
        "reason": null,
        "redirectUrl": "https://sandbox-checkout.onerway.com/checkout?key=c716f87fbf4c473f93948c618c507126&checkoutDetail=H4sIAAAAAAAAAMVXTXPbNhD9Kx6eLRkESRD0qQrtTJWxnYzkpNN2cgCBpcSUIlgQlKJm8t%2B74IcsOWrS5pBeNMQDFti3%2B7ALffJEXc%2BVd%2B35MY05JzxkQcxD4scJ9S69DRi5FpV90N41J4SS5AgTG0DDWQbl0crHj1W3H2U8i3wIJzKDfBKKIJnwiGUTJaXP8yBnnESnZo9Ftx8lNJqQZOKzC0qvI3rtJ1%2Bu%2B01XuLZqy%2FLSswjta2e6nN3deh0w2%2Bi2sgiRaUR6KG2NgUruEXy7vEGsabM3RqtW2sH8Zr64TR9xRgqjHDavcuT9%2ByevQEZ%2ByANGKYsTzkIWRTymTyvR%2Bt18OUPb%2BmTLdLZwR5V6pd8Iu0ZkbW3dXF9dGV0hHwVbXTeqEKtpVupsKrWB6a6olN410wrsld6Cwd8ajLCFriY7yCaNyj5ejSff4dZXsZ9DKCTPgUkIZBxmIfUh5jnNOFOUT%2BtqdcRryNzgMcYhHSaaPqafL08oR5QmScw4o88o38%2BWj7eLgeP%2FQpznOfFJwIRQICFKgKpc%2BQmKOctzn8fniZ%2F4%2FVX6IUkikgQBi%2FGDJuyE%2Fuz2P9CuhdzXYv8VxsMK6mZPWYYZCRQjwEGoIJSCBjLLMz8TVElfJNF5lp1730puQIIoIgHnDEmesLuZL9PX724XP4gjD8KcKyJ5LCmHhEDsx0wJLmmcyzgh0w%2F1GY5HTn5TxjThfhjRMPCfMX2VvvhBJOMAfMpoJGXIpGAKSALKDylVTNBQhOdJ9v59S6f4E3CfRwlWaf4skw%2B3i2V69%2FZH0SQhZRmLmZ9RTnyfYN3IGAjJcgVOsuf1euLmGbbvLz0sAk1h4chNBRs9xWZgdmKPLm6u0DYryrKoVjOlDDRo7e12u6mFxroFw7l9ae8bCOQ5SFts4b6oWuvOC0jXMl4bBea%2BWY0Lh42drdl0Zcm7%2FuTlhWnGZvhKVFCW4EIqDuBdm%2BldYf9y0V93jcvzOUn8KOA0dE0QNqIo3Y1VRhRVRH9aOWDwttaNFWWqlbOLWMRcXxYHbhGmm1zcF43dXywEpss1Y%2Bm6n%2BlbXZ%2FzbVHJLuGv3XRh3dyDNnZ9MVO6rNcllmQXdmsA7Mi3ajcZmHFUKKgsWj4MqBdSEsWouSBmXdRxtxthD335Q%2F3yKTIjdCeOkc9dohtpirqPZr%2FMgCoMpuStKUcIY2Bbx3fZPQaaRqwOuza6NRJS7CoYfFwi1yD%2F0K3t%2B37%2Fukmwb7MwxqAzhoqMqXsVGLCtqbpTngSlZfNcUFJg8Mojb6wRVSOk87nTyMNBS3ghNhim9DQBo0f3mMWyGdfmBZQq1VVerFojjgOAbFfQnOhsyAjs0pHd8xOP9nnpdm66p0vVa9Bp%2FmddOl8d4Lj%2F2WKQcepXHG1F2bpv%2FFRFU5di3024CnO0AWb%2Beyy32%2B%2BwOlzKTlL%2F1v59f0nPBwMn1yjiF2ducS7KBvrpX8YaM2CY%2FHnlrmDpwnyAM5TAkDxXBLrhmBJXTuebI4VmogEWuto4IlKX%2BnCztgXshnfzE5B2onthqxOw19URKlqrF8N9OVwqFLYT33ibcDBT20LCFxVvXlkwGMzuD0DCue%2BKizSAMf%2Bn5zgNvM9%2FA2ZV27c3DAAA", // 收银台支付链接
        "sign": "4585af83d9804c2fdbb144832735544688e323483a01b4a3fab4948c694c118c",
        "contractId": "",
        "tokenId": null,
        "eci": null,
        "transactionOrderNo": null,
        "periodValue": null,
        "lpmsType": null,
        "qrCode": null,
        "subscriptionManageUrl": null
    }
}
```
::

### 使用测试卡号

为了测试不同的支付场景，您可以使用以下测试卡号：

| 卡号 | 品牌 | 结果 |
|------|------|------|
| `4761344136141390` | Visa | 支付成功 |
| `4000020951595032` | Visa | 需要3DS验证 |
| `4000128449498204` | Visa | 卡片被拒绝 |

::note
更多测试卡号请参考 [测试卡号文档](https://docs.onerway.com/apis/zh/v0.6/test)
::

### 常见错误处理

在测试过程中，您可能遇到以下错误，请按提示处理：

| 错误码 | 描述 | 处理建议 |
|--------|------|----------|
| `40013` | Abnormal parameters (cannot be read) | 请检查环境变量是否配置完成 |
| `70002` | Unknown decline | 联系技术支持 |

::note
更多错误码信息请参考 [错误码文档](https://docs.onerway.com/failure)
::

## 查看交易信息

每当您通过 Onerway API 创建支付订单时，系统都会记录完整的交易信息。您可以在商户后台([Sandbox](https://sandbox-portal.onerway.com/transaction/query) | [Production](https://portal.onerway.com/transaction/query))查看和管理这些交易数据。

::u-dropdown-menu{:items='[{"label": "Sandbox", "to": "https://sandbox-portal.onerway.com/transaction/query"}, {"label": "Production", "to": "https://portal.onerway.com/transaction/query"}]' :content='{"align": "start"}'}
商户后台
::

### 交易列表

1. 访问您的**商户后台([Sandbox](https://sandbox-portal.onerway.com/transaction/query) | [Production](https://portal.onerway.com/transaction/query))**
2. 导航到**交易管理** 查看所有支付活动
3. **筛选和搜索** 按日期、状态或其他条件

### 交易详情

点击具体交易流水号可查看详细信息，页面包含以下模块：

::tabs

  :::tabs-item{label="交易信息"}
  - **交易流水号**：系统生成的唯一交易标识
  - **交易类型**：`Sale`、`Auth`等
  - **订单金额**：原始交易金额
  - **交易处理时间**：完整的处理时间戳
  - **支付响应码** / **响应信息**：API 返回的状态码和描述
  :::

  :::tabs-item{label="支付信息"}
  - **业务类型**：`CARD`（卡支付）、`LPMS`（本地支付）等
  - **支付模式**：`DIRECT`（直接支付）、`SUBSCRIBE`（订阅支付）、`TOKEN`（令牌化支付）
  - **支付方式**：`VISA`、 `Mastercard` 等卡组织
  - **发卡国家**：卡片发行国家/地区
  - **卡号**：脱敏显示的卡号信息（如：`4111 11** **** 1111`）
  :::

  :::tabs-item{label="3D认证"}
  - **是否请求3DS**：显示是否进行了3D Secure验证
  - **ECI**：电子商务指标值
  :::

  :::tabs-item{label="风控信息"}
  - **IP地址**：用户支付时的IP地址
  - **User Agent**：用户设备和浏览器信息
  - **拒付状态**：风控相关指标
  :::

  :::tabs-item{label="商户信息"}
  - **商户订单号**：您系统中的订单编号
  - **应用ID**：对应的应用标识
  - **交易网址**：支付发起的网站
  - **商品信息**：商品详情和价格信息
  - **接入方式**：集成方式说明
  :::

  :::tabs-item{label="客户地址"}
  - **账单地址**：包含姓名、邮箱、电话、完整地址等信息
  - **配送地址**：收货人信息和配送地址（如适用）
  :::

::

## 支付后处理

### 将客户重定向到返回页面

您可以自定义在客户完成付款后 Onerway 如何重定向客户

#### 设置重定向 URL

在支付请求中指定 `returnUrl`：

::code-collapse

```json
{
  "txnOrderMsg": {
    // ...其他字段...
    "returnUrl": "https://your-domain.com/payment/landing_page"
  }
}
```
::

::warning

请不要完全依赖 returnUrl 来处理支付状态，因为用户可能关闭浏览器或者网络中断，导致无法返回商户重定向页面。

[设置 Webhook 回调处理程序](mock/webhooks#set-up-webhook-handler)，这样 Onerway 可以直接发送支付事件到您的服务器，绕过客户端。如果 Webhook 通知[发送失败](/mock/webhooks){tooltip="商户未能正确响应"}，Onerway 会[重试多次](mock/webhooks#webhook-retry)。

::

### 处理 Webhook

为了接收异步的支付状态更新，您需要设置 webhook 接口地址

#### 设置 Webhook 接口地址

在支付请求中指定 `notifyUrl`：

::code-collapse

```json
{
  "txnOrderMsg": {
    // ...其他字段...
    "notifyUrl": "https://your-domain.com/webhook/onerway"
  }
}
```
::

#### Webhook 处理

请查阅 [Webhook](https://docs.onerway.com/apis/zh/v0.6/transaction-notification){badge="API"} 了解如何处理 Webhook 通知。

## 相关资源

::docs-see-also

  ::docs-see-also-item{to="https://docs.onerway.com/apis/" title="API 文档" description="完整的 API 参考文档"}
  ::

  ::docs-see-also-item{to="/get-started/start-building/start-developing/development-environment"}
  ::

::
