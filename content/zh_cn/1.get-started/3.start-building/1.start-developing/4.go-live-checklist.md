---
title: 上线前检查清单
description: 使用此检查清单确保您的集成已准备好投入生产环境。
stripeDocUrl: https://docs.stripe.com/get-started/checklist/go-live
---

Onerway 的沙盒环境和生产环境功能尽可能保持一致。在它们之间切换主要是替换您的 [API 密钥](/get-started/start-building/start-developing/set-up-your-development-environment#get-your-api-credentials)。

完成以下步骤以确保您的集成已准备好投入生产。

上线前，请确保您已：

- 使用边界情况测试集成
- 实现全面的错误处理
- 设置正确的日志记录
- 正确配置 webhook 端点
- 订阅 API 更新

## 快速检查清单

复制此清单以跟踪您的进度：

- [ ] 已使用不完整、无效和重复数据进行测试
- [ ] 错误处理涵盖所有场景
- [ ] 日志已配置（不包含敏感数据）
- [ ] 生产环境 webhook 端点已验证
- [ ] Webhook 可处理延迟和重复通知
- [ ] 已订阅 API 更新通知
- [ ] 已准备好切换到生产环境 API 密钥

## 测试边界情况

使用我们的测试值验证您的集成能够处理：

- **不完整数据** - 缺少必填字段或部分有效载荷
- **无效数据** - 格式错误、超出范围的值或类型不匹配
- **重复请求** - 重试同一请求以验证幂等性

::note
让非技术团队成员测试您的集成，以发现开发人员可能忽略的用户体验问题。
::

## 测试错误处理

在上线前验证您的集成能够处理所有错误场景。

### 需要测试的错误类型

| 错误类别 | 示例 | 用户显示 |
|---------|------|---------|
| 支付拒绝 | 余额不足、无效卡 | 显示支付相关的错误信息 |
| 验证错误 | 缺少字段、格式无效 | 高亮显示具体的字段错误 |
| 服务器错误 | 超时、5xx 响应 | 显示通用的"请重试"信息 |

::warning
不要向用户暴露内部错误详情。支付拒绝和验证错误需要不同的提示信息。
::

## 设置日志记录

Onerway 在管理平台中记录每个 API 请求。您也应该维护自己的日志作为备份，以应对以下场景：

- 网络问题导致请求无法到达 Onerway
- API 密钥问题导致请求无法被记录

### 日志安全检查清单

定期审计您的日志，确保：

- [ ] 仅包含必要的运营数据
- [ ] 不包含信用卡号
- [ ] 不包含个人身份信息（PII）
- [ ] 不包含 API 密钥和密钥

## 检查您的 Webhooks

您在沙盒和生产环境中可能使用不同的 webhook 端点。请验证：

- `notifyUrl` 参数与您的生产端点匹配
- 您的生产端点行为与测试端点完全一致

### 处理 Webhook 边界情况

在生产环境中处理 webhook 时，需要处理以下场景：

#### 延迟通知

如果 API 响应的支付结果表示最终状态，您可以更新商户订单状态。以下状态码表示最终状态：

| 状态 | 含义 |
|-----|------|
| `S` | 成功 |
| `F` | 失败 |

如果通过 `returnUrl` 重定向返回，请调用 Onerway [查询 API](https://docs.onerway.com/apis/zh/v0.6/order-query){badge="API"} 查询订单的最终状态。

如果未查到结果，请使用以下轮询频率查询交易结果：

- 10 秒
- 30 秒
- 60 秒
- 5 分钟
- 10 分钟
- 30 分钟

#### 重复通知

收到 webhook 通知后，将通知中的 `transactionID` 返回给 Onerway，以防止收到重复通知。

## 后续步骤

完成此检查清单后：

1. **订阅 API 更新** - 加入我们的邮件列表，接收新功能和变更通知
2. **切换到生产环境** - 更新您的 API 密钥和商户 ID
3. **监控您的集成** - 关注首批交易中的错误

::note
保留此检查清单，以便在启动新集成或更新现有集成时参考。
::
